---
title: "Pesca - Desembarques de capturas marítimas"
author: "Leonel Fernando Cejas"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(readr)
library(ggplot2)
library(lubridate)
library(tidyverse)


```

**Introducción**


El trabajo se realiza a partir de bases de datos brindados por el sitio web 
https://www.datos.gob.ar/ . Los datos del presente informe fueron provistos por
la Subsecretaría de Pesca y Acuicultura de la República Argentina.
Comprenden las capturas pesqueras realizadas por buques que operan dentro de la
ZEE de la República Argentina en el período de 2010 a 2018.


## Exploración de los datos

** En primer lugar hacemos una exploración de los datos y seguidamente asignamos 
a una variable la base de datos completa con la que elegí trabajar**


```{r}
captura_puerto_flota_2010_2018 <- read_csv("datos/captura-puerto-flota-2010-2018.csv", 
                                           locale = locale(encoding = "windows-1252"))
```
##Contiene 41341 observaciones y 13 variables que son las que se mencionan a 
continuación: 


```{r}
str(captura_puerto_flota_2010_2018)
```
##Como la columna "fecha" se encuentra en caracteres se procede a convertirla
## a formato fecha


```{r}
captura_puerto_flota_2010_2018 <-
  captura_puerto_flota_2010_2018 |> 
  mutate(fecha = ym (fecha))
  
```


##Se realiza una visualizacion de las columnas


```{r}
colnames(captura_puerto_flota_2010_2018)
```
## Las 13 variables con las que contamos para el análisis son las siguientes:


"fecha"            "flota"            "puerto"           "provincia"        "provincia_id"    
"departamento"     "departamento_id"  "latitud"          "longitud"         "categoria"       
"especie"          "especie_agrupada" "captura"         

**Especies del Mar Argentino**

```{r}
lista_de_especies <-
  unique(captura_puerto_flota_2010_2018$especie) |> 
  print()
```

```{r}
captura_puerto_flota_2010_2018_2<-
  captura_puerto_flota_2010_2018 |> 
  mutate(especie = fct_lump(especie, n = 10)) |> 
  filter(especie != "other") |> 
  count(especie, sort = TRUE) |> 
  print()
```
#Se observan 89 especies marítimas. Al ser demasiadas, dificulta el análisis y
la visualización de los datos. Por ende, se opta por un número de especies
mas reducido y representativo. Tomamos las primeras diez especies y le 
agregamos la especie "Merluza negra" por ser  de importancia comercial
y científica, además de estar regulada regulada por la FAO.


```{r}
especies_repre <-
  captura_puerto_flota_2010_2018 |> 
  filter (especie %in% c("Merluza hubbsi", "Rayas nep", "Pez gallo", "Lenguados nep", "Pescadilla", "Langostino", "Gatuzo", "Corvina blanca", "Mero","Merluza negra"))
  
```
  

```{r}

  ggplot(data = especies_repre, mapping = aes(x = fecha, y = captura)) + 
  geom_line (aes(colour = especie))+
  labs(title = "Capturas Marítimas de las principales especies argentinas",
       subtitle = "Desde 2010 hasta 2018",
       x = "Año",
       y = "Captura")
```
**Exploración de los datos**

Seleccioná algunas variables resulten interesantes y mostrá sus propiedades.
Algunas cosas para mostrar:

-   ¿Cuál es su valor medio y desvío estándard?
-   ¿Cuál es su rango (valor máximo y valor mínimo)?
-   ¿Hay alguna anomalía que sugiera que hay datos incorrectos? Valores imposibles (como valores negativos en una variable que sólo puede ser positiva) o poco creíbles.
-   ¿Cuántas observaciones hay por cada grupo? ¿Cuántos valores faltantes? ¿Hay diferencias?


```{r}
esp_repre<-
  especies_repre |>
  mutate(total_puerto = sum(captura, na.rm = TRUE)) |> 
  group_by(especie) |>
  summarise(total_especie = sum(captura))
```



```{r}
repre_esp_tot<-
  esp_repre |> 
  mutate(captura_total= sum(total_especie, na.rm = TRUE)) |> 
  mutate(especie_sobre_total = total_especie/captura_total) |> 
  arrange(-especie_sobre_total) |> 
  print()

```


```{r}
p<-
especies_repre %>% 
  group_by(puerto) %>% 
  summarise(cantidad = n())
```



```{r}
  p |>
  ggplot(aes(cantidad, puerto))+ 
  geom_col() 
```

Se observa una preponderancia de los puertos de la provincia de Buenos Aires, 
destacándose, sobre todo, el Puerto de Mar Del Plata.
Mar del Plata es el puerto mas grande del país y uno de los mas importantes de 
Sudamérica.

##borrador

```{r}
e<-
especies_repre %>% 
  group_by(puerto) %>% 
  summarise(captura = sum(captura))
```



```{r}
  e |>
  ggplot(aes(captura, puerto))+ 
  geom_col() 
```






```{r}
experimento_1<-
  especies_repre %>%
  group_by(puerto)%>%
  count(especie)
```

#cuantas especies aparecen por puerto

```{r}
data_count<-  experimento_1 %>%

  summarise(count = n_distinct(especie))
```






```{r}
for (g in unique(experimento_1$puerto)) {
    miembros <- filter(experimento_1, puerto == g)


  print(paste("El puerto de", g, "registra una captura de", nrow(miembros), "especie/s"))}
```

