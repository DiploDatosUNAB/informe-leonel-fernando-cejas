---
title: "Pesca - Desembarques de capturas marítimas"
author: "Leonel Fernando Cejas"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


```{r}
library(dplyr)
```


```{r}
library(ggplot2)
```


```{r}
library(gitcreds)
```

```{r}
library(readr)
```


```{r}
library(usethis)
```






**Introducción**


El trabajo se realiza a partir de bases de datos privistas por la Subsecretaría
de Pesca y Acuicultura de la Repùblica Argentina. Comprenden las capturas 
realizadas por buques que operan dentro de la ZEE de la Repùblica Argentina en 
el período de 2010 a 2018



## Exploración de los datos

```{r}
library(readr)
captura_puerto_flota_2010_2018 <- read_csv("datos/captura-puerto-flota-2010-2018.csv")

```



```{r}
read.csv("datos/captura-puerto-flota-2010-2018.csv")
```


```{r}
filter(captura_puerto_flota_2010_2018, provincia_id == "06")

```
estos datos se pierden

```{r}
filter(captura_puerto_flota_2010_2018, puerto == "Mar del Plata")

```

```{r}
captura_puerto_flota_serie_tiempo <- read_csv("datos/captura-puerto-flota-serie-tiempo.csv")
```

```{r}
read.csv ("datos/captura-puerto-flota-serie-tiempo.csv")
```





```{r}
captura_puerto_flota_2010_2018 |> 
  filter ( fecha %in% c("2010-04", "2010-05", "2010-06")) |> 
  group_by(puerto) 
  

```
## otra forma de seleccionar un rango sin escribir todo

```{r}
captura_puerto_flota_2010_2018 |>
  filter(fecha >= "2010-04") |>
  filter(fecha <= "2010-06")
  
```











```{r}
 captura_puerto_flota_2010_2018 |>
  filter(fecha=="2010-01") |>
  mutate(proporcion = captura [especie = "Merluza hubbsi"]/captura)
  

```

##captura media es la suma de la captura por especie dividido el nro de casos, que son 26



```{r}
captura_puerto_flota_2010_2018 |> 
   filter(fecha=="2010-01") |>
  group_by(especie) |> 
  summarise(captura_media=mean(captura, na.rm =TRUE))
```

quiero saber cuantos casos aparece merluza hubbsi en lo anterior

```{r}

library(tidyverse)
aparece_especie <- captura_puerto_flota_2010_2018 %>%
  
  filter(fecha=="2010-01") |>
  group_by(especie) |>
  tally()
  
```

```{r}
unique(captura_puerto_flota_2010_2018$especie)
```
##tiene 13 columnas!

```{r}
library(dplyr)
glimpse(captura_puerto_flota_2010_2018)
```

suma de la captura filtrando fecha


```{r}
captura_2010_01_todas <- captura_puerto_flota_2010_2018 |> 
  filter(fecha=="2010-01") |>
  summarise(captura = sum(captura))

```


## ahora sumo la captura de la merluza en ese periodo


```{r}
captura_2010_01_Merluzahubbsi <- captura_puerto_flota_2010_2018 |> 
  filter(fecha == "2010-01") |> 
  filter(especie == "Merluza hubbsi") |> 
  summarise(captura = sum(captura))

```

ahora le asigno una variable a cada cosa y saco la media

```{r}
captura_2010_01_Merluzahubbsi/captura_2010_01_todas

```
## averiguar como fueron las capturas por especies por año y hacer un cuadro a traves del tiempo




```{r}
captura_puerto_flota_2010_2018 |> 
  filter (especie %in% c("Merluza hubbsi", "Rayas nep", "Langostino", "Calamar Illex"))
```


## hago variable de  especies representativas (especies_repre)

```{r}

especies_repre <-
  captura_puerto_flota_2010_2018 |> 
  filter (especie %in% c("Merluza hubbsi", "Rayas nep", "Langostino", "Calamar Illex")) 
  

```





```{r}
especies_repre |> 
  ggplot(data = especies_repre, mapping = aes(x = fecha, y = captura)) + 
  geom_line (aes(colour = especie))
```





** Ensancho la tabla agregando una columna para cada especie**

```{r}
especies_repre


```

```{r}
especies_repre |> 
  pivot_wider(names_from = especie, values_from = captura, values_fill = 0)
```


```{r}
captura_puerto_flota_2010_2018 |>
  pivot_wider(names_from = especie, values_from = captura, values_fill = 0) |> 
  arrange(fecha)
 


```

**lista de especies**


```{r}

lista_de_especies <-
  unique(captura_puerto_flota_2010_2018$especie)
```

**Cantidad de Variables que contiene la base** 

```{r}
colnames(captura_puerto_flota_2010_2018)
```

```{r}
captura_por_especie <-
  captura_puerto_flota_2010_2018[c("fecha", "flota", "puerto", "especie", "captura")]

```




```{r}
captura_agrupada_especie |> 
  pivot_wider(names_from = especie, values_from = captura, values_fill = 0) |> 
  arrange(fecha)
```















