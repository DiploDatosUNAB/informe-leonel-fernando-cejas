---
title: "Capturas pesqueras y visualización de datos"
author: "Leonel Fernando Cejas"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(readr)
library(ggplot2)
library(lubridate)
library(wesanderson)
```


**Introducción** 


El trabajo se realiza a partir de bases de datos públicas brindadas por el
sitio https://www.datos.gob.ar/ . Los datos del presente informe fueron provistos por
la Subsecretaría de Pesca y Acuicultura de la República Argentina.
Comprenden las capturas pesqueras realizadas por buques que operan dentro de la
ZEE de la República Argentina en el año 2018.
Intentaremos brindar un panorama completo sobre el comportamiento e las tres principales 
especies capturadas, desde esl punto de vista comercial:
"Langostino", "Merluza hubbsi"y "Calamar Illex"
Por otro lado, con el fin de facilitar la visualización" se analizaran los principales
puertos de la patagonia, "Rawson", "Puerto Madryn"y "Puerto Deseado".




** En primer lugar hacemos una exploración de los datos y seguidamente asignamos 
a una variable la base de datos completa con la que elegí trabajar**


```{r}
captura_puerto_flota_2010_2018 <- read_csv("datos/captura-puerto-flota-2010-2018.csv", 
                                           locale = locale(encoding = "windows-1252"))
```

Conociendo la bases:

```{r}
str(captura_puerto_flota_2010_2018)
```

Debido a que la variable "fecha" se encuentra en formato de caracteres se 
procede a convertirla a formato fecha


```{r}
captura_puerto_flota_2010_2018 <-
  captura_puerto_flota_2010_2018 |> 
  mutate(fecha = ym (fecha))
  
```


La base de datos contiene 41341 observaciones y 13 variables.
Las variables se mencionan a continuación: 


```{r}
colnames(captura_puerto_flota_2010_2018)
```
         

**Especies del Mar Argentino**

La plataforma continental argentina es una de las mas extensas y mas ricas en 
biodiversidad del mundo. Nuestro país posee derechos exclusivos de explotar los 
recursos marítimos hasta la milla 200. Mas allá de este límite comienzan las
denominadas "aguas internacionales". Las siguientes especies son capturadas por
buques de bandera argentina y descargan lo capturado en puertos argentinos.

```{r}
lista_de_especies <-
  unique(captura_puerto_flota_2010_2018$especie) |> 
  print()
```


Se observan un total 89 especies marítimas. Al ser demasiadas,  dificulta el 
análisis y la visualización de los datos. Por ende, se opta por un número de
especies mas reducido y representativo. 
Se tomaran las especies "Langostino", "Merluza hubbsi" y "Calamar Illex"
Asimismo los análisis serán para la zafra 2018, por la misma razón



```{r}
mt_especie_2018 <- captura_puerto_flota_2010_2018 %>%
  select(especie, puerto, fecha, captura)%>%
  filter(fecha >= as.Date("2018-01-01") & fecha <= as.Date("2018-12-01")) %>%
 
  group_by(especie)%>%
  summarise(total_mt = sum(captura/1000000))%>%


  arrange(-total_mt)
  
  print(mt_especie_2018)
  
```


```{r}
especie_2018<- mt_especie_2018%>%
  
  filter (especie %in% c("Langostino", "Merluza hubbsi", "Calamar Illex"))
  
  
```

  
Se observa una preponderancia total del principal recurso marino argentino, 
la Merluza hubbsi o merluza común

```{r}
ggplot(especie_2018, aes(x= especie, y = total_mt))+
  geom_bar(stat = "identity", fill = "skyblue") +

  labs(
    title = "Captura de especies pesqueras en 2018",
    subtitle = "Principales especies comerciales",
    x = "Especie",
    y = "Miles de toneladas"
  )


```

 
  El siguiente cuadro nos muestra la variación del la captura de las principales
  especies durante el período de estudio. La captura está expresada en miles de toneladas
  

```{r}
df_2018 <-
  captura_puerto_flota_2010_2018 %>%
  select(fecha,puerto,especie,flota,captura)%>%
  filter (especie %in% c("Langostino", "Merluza hubbsi", "Calamar Illex"))%>%
  filter(fecha >= as.Date("2018-01-01") & fecha <= as.Date("2018-12-01"))%>%
  filter(puerto %in% c ("Rawson", "Puerto Madryn", "Puerto Deseado"))%>%
  mutate(toneladas = captura/ 1000)%>%
  print()
```




```{r}
df_2018 <- df_2018 %>%
  mutate(mes = lubridate::month(fecha))


df_2018_agrupados <- df_2018 %>%
  
  group_by(mes,especie) %>%
  summarise(suma_de_toneladas = sum(toneladas))%>%

  print()
```

El langostino es especie acompañante de la merluza. Es decir se encuentran en la misma zona.
De acuerdo a parámetros biológicos (migración, tamaño, adultez, etc) se establecen 
zonas de veda para determinadas especies.
Nótese en el siguiente cuadro la relación inversa entre la captura de estas dos especies.
La captura de calamar posee picos en marzo, mayo y octubre

  
```{r}
ggplot(df_2018_agrupados, aes(mes, suma_de_toneladas)) +
  geom_point(aes(color = especie))+
  geom_line(aes(color = especie))+
  scale_x_continuous(breaks = 1:12, labels = c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Agos", "Sep", "Oct", "Nov", "Dic")) +
  labs(title = "Variacion mensual de capturas, año 2018",
       subtitle = "Fuente: datos.gob.ar",
       x = "mes",
       y = "Captura en toneladas",
       fill = "Especie")
  
```
  


**Sobre los puertos**

Se observa una preponderancia de Puerto Madryn, asimismo las descargas de la
especie Merluza hubbsi o merluza común se destacan sobre el resto


```{r}
df_2018_agrupados_puerto <- df_2018 %>%
  
  group_by(puerto ,especie) %>%
  summarise(suma_toneladas = sum(toneladas))%>%

  print()
```



```{r}
df_2018_agrupados_puerto |>
  
  ggplot(data = df_2018_agrupados_puerto, mapping = aes(x = puerto, y = suma_toneladas))+
    geom_col(aes(fill = especie), position = "dodge")+
    theme(legend.position = "bottom")
```





```{r}
  df_2018 |>
  ggplot(aes(captura, puerto))+ 
  geom_col()+
  hrbrthemes::theme_ft_rc() + 
  ggtitle("Capturas por Puerto") + 
  theme(legend.title = element_blank(),
        legend.text = element_text(size = 15),
        plot.title = element_text(size = 20)) %>%
  scale_color_manual(values= wes_palette("GrandBudapest1"))
```




**Capturas por tipo de flota**

Este item nos ayuda a comprender la distribución de la captura de acuerdo a la
embarcación utilizada para la pesca.
En primer lugar aparecen los tangoneros. Estos buques capturan como especie objetivo
al Langostino. Debido a la cercanía de la zona de pesca con los puertos
patagónicos, suelen descargar su captura en los mismos

En segundo lugar se observan los buques congeladores o factorias.
Son los de mayor envergadura. El pescado capturado se procesa y congela a bordo.
Sus mareas pueden durar meses. Las distinciones entre distintos
congeladores se realiza en base al arte de pesca (redes, anzuelos, trampas)
utilizados para pescar.

En un tercer escalon se encuentran los buques fresqueros, costeros y de rada o ría.
Estos buque son medianos o pequeños, se abocan a la captura de merluza y de varido
costero. Conservan las capturas en cajones con escamas de hielo y sus viajes de
pesca pueden duran dias o unas pocas semanas.

Por último aparecen los poteros. Los poteros se especializan en la captura de 
Calamar Illex. Realizan la pesca de noche usando lamparas de gran poder que
inducen al calamar a ascender y son capturados por unos "anzuelos poteros". 




```{r}
flota <-
  unique(captura_puerto_flota_2010_2018$flota) |> 
  print()
```



  geom_col(aes(fill = flota))+

```{r}

df_2018 |>
  na.omit() |> 
  ggplot(aes(flota, captura/1000))+
  geom_point(aes(color = flota , size = captura)) +
  
  scale_x_discrete(labels = c("Costeros" = "Costeros",
                              "Rada o ría" = "Rada",
                              "Congeladores tangoneros"= "Tangoneros",
                              "Congeladores arrastreros"= "Factorias",
                              "Congeladores poteros nacionales" = "Poteros",
                              Fresqueros="Fresqueros"))+
                     labs(title = "Capturas Marítimas según tipo de flota 2018",
       subtitle = "Fuente: datos.gob.ar",
       x = "Tipo de flota",
       y = "Captura en toneladas") %>%
  print()

```



